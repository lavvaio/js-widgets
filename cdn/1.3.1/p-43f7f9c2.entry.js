import{r as s,c as e,h as t}from"./p-878bd889.js";import{S as i,f as a,W as l,C as o}from"./p-189a6ab1.js";import{s as n}from"./p-1c3cb269.js";import{a as r,t as h}from"./p-b0f56eea.js";let m=class{constructor(t){s(this,t),this.symbolClick=e(this,"symbolClick",7),this.subscriptions=new i,this.host="xxxxxxxxxx.apps.anadyme.com",this.locale="en",this.translations=null,this.format="binary",this.encoding="msgpack",this.size="default",this.center=!1,this.animation=!0,this.symbols=[{key:"BTCUSDm",label:"BTC/USD",image:"/build/assets/svg/BTCUSDm.svg"},{key:"XAUUSDm",label:"Gold/USD",image:"/build/assets/svg/XAUUSDm.svg"},{key:"EURUSDm",label:"EUR/USD",image:"/build/assets/svg/EURUSDm.svg"},{key:"USOILm",label:"US Oil",image:"/build/assets/svg/USOILm.svg"},{key:"ETHUSDm",label:"ETH/USD",image:"/build/assets/svg/ETHUSDm.svg"},{key:"EURUSDm",label:"EUR/USD",image:"/build/assets/svg/EURUSDm.svg"},{key:"USDJPYm",label:"USD/JPY",image:"/build/assets/svg/USDJPYm.svg"},{key:"GBPUSDm",label:"GBP/USD",image:"/build/assets/svg/GBPUSDm.svg"},{key:"USDCHFm",label:"USD/CHF",image:"/build/assets/svg/USDCHFm.svg"},{key:"USDCADm",label:"USD/CAD",image:"/build/assets/svg/USDCADm.svg"},{key:"USTECm",label:"US Tech 100",image:"/build/assets/svg/USTECm.svg"},{key:"UK100m",label:"UK 100 Index",image:"/build/assets/svg/UK100m.svg"},{key:"STOXX50m",label:"EU 50 Index",image:"/build/assets/svg/STOXX50m.svg"},{key:"HK50m",label:"HK 50 Index",image:"/build/assets/svg/HK50m.svg"},{key:"DE30m",label:"DE 30 Index",image:"/build/assets/svg/DE30m.svg"},{key:"XAUUSDm",label:"Gold/USD",image:"/build/assets/svg/XAUUSDm.svg"},{key:"XAGUSDm",label:"Silver/USD",image:"/build/assets/svg/XAGUSDm.svg"},{key:"USOILm",label:"US Crude Oil",image:"/build/assets/svg/USOILm.svg"},{key:"XPDUSDm",label:"Palladium/USD",image:"/build/assets/svg/XPDUSDm.svg"},{key:"XPTUSDm",label:"Platinum/USD",image:"/build/assets/svg/XPTUSDm.svg"},{key:"AAPLm",label:"Apple",image:"/build/assets/svg/AAPLm.svg"},{key:"BABAm",label:"AliBaba",image:"/build/assets/svg/BABAm.svg"},{key:"Cm",label:"CitiGroup",image:"/build/assets/svg/Cm.svg"},{key:"KOm",label:"CocaCola",image:"/build/assets/svg/KOm.svg"},{key:"NFLXm",label:"Netflix",image:"/build/assets/svg/NFLXm.svg"}],this.apiKey="aaaaaaaa-bbbb-cccc-dddd-eeeeeeeeeeee",this.snapshot=!0,this.useCache=!0,this.namespace="mt-marquee",this.data=[],this.loading=!0,this.storage=new Map,this.debug=!1,this.autoconnect=!0,this.connection=null,this.marqueeSet=!1,this.ref=null}createLogger(){this.logger=r(this.namespace,"background-color:red;color:#fff;padding: 2px 4px;font-size:10px;border-radius:4px;")}connect(s,e){this.autoconnect&&e?this.log("could not subscribe to events"):(this.subscriptions.add(this.connection.channelStream(this.channel).pipe(a((s=>s.type===o.CLIENT_CONNECTED))).subscribe((s=>{this.log("client connected",s.value.client_id,s)}))),this.subscriptions.add(this.connection.channelStream(this.channel).pipe(a((s=>s.type===o.DATA)),a((s=>"ticks"===s.category))).subscribe((s=>{this.saveQuote(s.value)}))))}async log(...s){this.debug&&this.logger.log(...s)}translate(s,e){return h(s,e,this.translations,this.locale)}loadQuotes(){if(this.log("loading quotes"),this.useCache){const s=n.namespace(this.namespace);this.data=s.get(this.channel,this.data),this.storage=new Map((this.data||[]).map((s=>[s.Symbol,s]))),this.log("cached quotes found",this.data)}}saveQuote(s){this.log(">> saving quote",s),this.storage.has(s.Symbol)&&this.storage.get(s.Symbol).Time>s.Time?this.log("detected older quote",s):(this.loading&&(this.loading=!1),this.storage.set(s.Symbol,s),this.data=Array.from(this.storage,(([s,e])=>e)),this.useCache&&n.namespace(this.namespace).set(this.channel,this.data))}connectedCallback(){this.log("widget attached",this.locale),this.loadQuotes(),this.autoconnect&&(this.connection=new l({host:this.host,format:this.format,encoding:this.encoding,channels:this.channel?[this.channel]:[],apiKey:this.apiKey}),this.subscriptions.add(this.connection.connect()))}componentWillUpdate(){this.ref&&(this.marqueeSet||(this.marqueeSet=!0))}disconnectedCallback(){this.subscriptions.unsubscribe()}renderSymbol(s){const e=this.storage.get(s.key),i=parseFloat(`${e.PerDiff||0}`).toFixed(3),a=e.Digits?parseFloat(`${e.Bid}`).toFixed(e.Digits):e.Bid;return t("div",{class:"quote",onClick:()=>this.symbolClick.emit(s)},t("span",{class:"symbol"},s.label),t("span",{class:"bid"},a),t("span",{class:e.PerDiff>0?"change up":e.PerDiff<0?"change down":"change"},e.PerDiff>0?"+":"",i,"%"))}renderLoading(){return t("div",{class:"loader"},t("span",{class:"txt"},this.translate("loading","Loading...")))}render(){const s=["size-default"];this.center&&s.push("center");const e=["ticker__list"];return this.animation||e.push("no-animation"),t("div",{class:s.join(" ")},this.loading&&this.renderLoading(),!this.loading&&t("div",{class:"quotes",ref:s=>this.ref=s},t("div",{class:e.join(" ")},this.symbols.filter((s=>this.storage.has(s.key))).map((s=>this.renderSymbol(s)))),this.animation&&t("div",{class:e.join(" ")},this.symbols.filter((s=>this.storage.has(s.key))).map((s=>this.renderSymbol(s))))))}static get assetsDirs(){return["./assets"]}static get watchers(){return{namespace:["createLogger"],connection:["connect"]}}};m.style="@-moz-keyframes ticker{100%{transform:translateX(-100%)}}@-webkit-keyframes ticker{100%{transform:translateX(-100%)}}@-o-keyframes ticker{100%{transform:translateX(-100%)}}@keyframes ticker{100%{transform:translateX(-100%)}}:host{--padding:14px;--font-size:14px;--background-color:rgb(38, 38, 38);--symbol-name-color:#dadbdf;--symbol-value-color:#ffffff;--symbol-percent-up:rgb(0, 217, 100);--symbol-percent-down:rgb(255, 0, 0);--symbol-loading-font-size:0.875rem;--symbol-loading-color:#dadbdf}:host .size-default{background:var(--background-color);font-size:var(--font-size);padding:var(--padding);box-sizing:border-box;height:44px}:host .size-default .loader{font-family:inherit;font-weight:500;display:flex;align-items:center;justify-content:center;color:var(--symbol-loading-color);font-size:var(--symbol-loading-font-size)}:host .size-default .quotes{list-style:none;padding:0;margin:0 auto;display:flex;overflow:hidden;box-sizing:border-box}:host .size-default .quotes:hover .ticker__list{animation-play-state:paused}:host .size-default .quotes .ticker__list{display:flex;animation:ticker 90s infinite linear}:host .size-default .quotes .ticker__list.no-animation{animation:none}:host .size-default .quotes .ticker__list .quote{display:flex;margin-right:40px;cursor:pointer}:host .size-default .quotes .ticker__list .quote .symbol{margin-right:10px;font-weight:300;color:var(--symbol-name-color);white-space:nowrap}:host .size-default .quotes .ticker__list .quote .bid{font-weight:500;margin-right:10px;color:var(--symbol-value-color)}:host .size-default .quotes .ticker__list .quote .change{font-weight:400}:host .size-default .quotes .ticker__list .quote .change.up{color:var(--symbol-percent-up)}:host .size-default .quotes .ticker__list .quote .change.down{color:var(--symbol-percent-down)}";export{m as mt_marquee}