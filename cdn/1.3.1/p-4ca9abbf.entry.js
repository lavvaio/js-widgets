import{r as s,h as i}from"./p-878bd889.js";import{S as e,f as n,C as t}from"./p-189a6ab1.js";import{s as o}from"./p-1c3cb269.js";import{a,l as h}from"./p-b0f56eea.js";let r=class{constructor(i){s(this,i),this.dataKey=void 0,this.namespace="finnhub-news",this.useCache=!0,this.size=1,this.data=[],this.debug=!1,this.logger=a("finnhub-news"),this.subscriptions=new e}async log(...s){this.debug&&this.logger.log(...s)}connectedCallback(){if(this.loadNews(),!this.connection)throw new Error("connection was not found");this.subscriptions.add(this.connection.channelStream(this.channel).pipe(n((s=>s.type===t.CLIENT_CONNECTED))).subscribe((s=>{this.log("client connected",s.value.client_id),this.size=s.value.channel_size}))),this.subscriptions.add(this.connection.channelStream(this.channel).pipe(n((s=>s.type===t.DATA)),n((s=>void 0===this.dataKey||s.key===this.dataKey))).subscribe((s=>{this.saveNews(s.value)})))}loadNews(){if(this.useCache){const s=o.namespace(this.namespace);this.data=s.get(this.channel,this.data)}}saveNews(s){this.data.find((i=>i.id===s.id))||h(s.image).then((()=>{this.data=[s,...this.data.slice(0,this.size-1)].sort(((s,i)=>i.datetime-s.datetime)),this.useCache&&o.namespace(this.namespace).set(this.channel,this.data)}))}disconnectedCallback(){this.subscriptions.unsubscribe()}render(){return i("div",null,i("div",{class:"finnhub"},i("ul",{class:"news"},this.data.map((s=>i("li",null,i("div",{class:"news-item"},i("div",{class:"cover"},i("img",{src:s.image,alt:s.headline,title:s.headline})),i("div",{class:"body"},i("div",{class:"title"},s.headline),i("div",{class:"date"},new Date(1e3*s.datetime).toISOString()),i("div",{class:"summary",innerHTML:s.summary}),i("div",{class:"footer"},i("div",{class:"source"},i("span",{class:"label"},"Source: "),s.source),i("a",{href:s.url,class:"learnmore",target:"_blank"},"Learn more"))))))))),i("div",{class:"powered-by"},"Powered by Finnhub"))}};r.style='.powered-by{font-size:9px;font-family:"monospace";opacity:0.5;padding:2px 0}.finnhub{display:block;font:14px Roboto, Helvetica, Arial, Tahoma, sans-serif}.finnhub .news{list-style:none;padding-left:0}.finnhub .news .news-item{max-width:522px;padding:15px;border-radius:4px;border:1px solid rgba(160, 200, 220, 0.12);display:flex;margin-bottom:15px}.finnhub .news .news-item .cover{border-radius:4px;position:relative}.finnhub .news .news-item .cover img{width:180px}.finnhub .news .news-item .body{padding:0 15px}.finnhub .news .news-item .body .title{font-size:18px;line-height:24px;font-weight:500}.finnhub .news .news-item .body .date{font-weight:400;font-size:14px;margin:5px 0;opacity:0.5}.finnhub .news .news-item .body .summary{font-size:14px;line-height:24px;font-weight:300;margin-top:5px}.finnhub .news .news-item .body .summary ul,.finnhub .news .news-item .body .summary ol{padding-left:15px}.finnhub .news .news-item .body .footer{margin:10px 0;display:flex;font-size:12px;line-height:20px;justify-content:space-between}.finnhub .news .news-item .body .footer .source{font-weight:700;opacity:0.5}.finnhub .news .news-item .body .footer .source .label{font-weight:300}.finnhub .news .news-item .body .footer .learnmore{color:#808080}';export{r as finnhub_news}