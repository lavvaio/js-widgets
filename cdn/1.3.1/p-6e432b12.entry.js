import{r as t,h as i}from"./p-878bd889.js";import{S as s,f as e,C as o}from"./p-189a6ab1.js";import{s as r}from"./p-1c3cb269.js";import{a as n}from"./p-b0f56eea.js";let a=class{constructor(i){t(this,i),this.dataKey=[],this.namespace="fxcm-rates",this.rates=new Map,this.data=[],this.size=1,this.useCache=!0,this.symbolNames=[],this.debug=!1,this.logger=n("fxcm-rates"),this.subscriptions=new s}async log(...t){this.debug&&this.logger.log(...t)}connectedCallback(){if(this.loadRates(),!this.connection)throw new Error("connection was not found");this.subscriptions.add(this.connection.channelStream(this.channel).pipe(e((t=>t.type===o.CLIENT_CONNECTED))).subscribe((t=>{this.log("client connected",t.value.client_id),this.size=t.value.channel_size}))),this.subscriptions.add(this.connection.channelStream(this.channel).pipe(e((t=>t.type===o.DATA)),e((t=>void 0===this.dataKey||0===this.dataKey.length||this.dataKey.includes(t.key)))).subscribe((t=>{this.saveRate(t.value)})))}saveRate(t){this.rates.set(t.Symbol,t),this.data=Array.from(this.rates,(([t,i])=>({name:t,value:i}))),this.useCache&&r.namespace(this.namespace).set(this.channel,this.data)}loadRates(){if(this.log("loading rates"),this.useCache){const t=r.namespace(this.namespace);this.data=t.get(this.channel,this.data),this.rates=new Map((this.data||[]).map((t=>[t.name,t.value])))}}disconnectedCallback(){this.subscriptions.unsubscribe()}getDirectionClass(t){return 1===t.Direction?"entry direction-up":-1===t.Direction?"entry direction-down":"entry direction-none"}render(){return i("div",null,i("div",{class:"fxcm-rates"},i("section",{class:"top"},i("div",null,"Symbol"),i("div",null,"Bid"),i("div",null,"Ask"),i("div",null,"Low"),i("div",null,"High"),i("div",null,"Last Updated")),i("section",{class:"entries"},this.data.map((t=>i("section",{class:this.getDirectionClass(t.value)},i("div",null,t.value.Symbol),i("div",null,t.value.Bid),i("div",null,t.value.Ask),i("div",null,t.value.Low),i("div",null,t.value.High),i("div",null,t.value.LastUpdated)))))),i("div",{class:"powered-by"},"Powered by FXCM rates"))}};a.style='.powered-by{font-size:10px;font-family:"monospace";opacity:0.5;padding:2px 0}.fxcm-rates{display:block;max-width:700px;margin-bottom:2px;padding:15px;border:1px solid #e0e3eb;font:14px Roboto, Helvetica, Arial, Tahoma, sans-serif}.fxcm-rates .top{display:flex}.fxcm-rates .top div{flex:1;color:#9598a1;font-size:15px;font-weight:500;margin-bottom:10px}.fxcm-rates .entries{max-height:210px;overflow-y:overlay}.fxcm-rates .entries .entry{display:flex;border-bottom:1px solid #e0e3eb}.fxcm-rates .entries .entry.direction-none{color:#131722}.fxcm-rates .entries .entry.direction-up{color:#3cbc98}.fxcm-rates .entries .entry.direction-down{color:#ff4a68}.fxcm-rates .entries .entry:hover{background-color:#f7f8fa}.fxcm-rates .entries .entry div{flex:1;padding:9px 0}';export{a as fxcm_rates}